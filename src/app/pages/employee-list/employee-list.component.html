<div class="employee-list-container">
  <div class="header-bar">
    <h2>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
    <div class="actions">
      <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." [(ngModel)]="searchText" (ngModelChange)="onSearchChange($event)">

      <select [(ngModel)]="selectedDepartment" (change)="filterEmployees()">
        <option value="">‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option>
        <option *ngFor="let dept of uniqueDepartments()" [value]="dept">{{ dept }}</option>
      </select>

      <select (change)="changeItemsPerPage($event)">
        <option [value]="10" [selected]="itemsPerPage === 10">10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
        <option [value]="15" [selected]="itemsPerPage === 15">15 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
        <option [value]="20" [selected]="itemsPerPage === 20">20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>
      </select>

      <button class="add-button" (click)="addEmployee()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</button>
      <button class="excel-button" (click)="exportToExcel()">üì• Excel</button>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠</th>
        <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
        <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏à‡πâ‡∏≤‡∏á</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngIf="employees.length === 0">
        <td colspan="8" style="text-align: center;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á</td>
      </tr>
      <tr *ngIf="employees.length > 0 && filteredEmployees.length === 0">
        <td colspan="8" style="text-align: center;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</td>
      </tr>
      <tr *ngFor="let emp of paginatedEmployees">
        <td data-label="‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">{{ emp.employeeId }}</td>
        <td data-label="‡∏ä‡∏∑‡πà‡∏≠">{{ emp.firstName }} {{ emp.lastName }}</td>
        <td data-label="‡πÅ‡∏ú‡∏ô‡∏Å">{{ emp.department }}</td>
        <td data-label="‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á">{{ emp.position }}</td>
        <td data-label="‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏à‡πâ‡∏≤‡∏á">{{ emp.employmentType }}</td>
        <td data-label="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">{{ emp.workStatus }}</td>
        <td data-label="‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">{{ emp.user?.role || '‚Äî' }}</td>
        <td data-label="‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£">
          <button class="btn-edit" (click)="editEmployee(emp._id)">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button> &nbsp;
          <button class="btn-delete" (click)="deleteEmployee(emp._id)">‡∏•‡∏ö</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pagination-controls">
    <button (click)="previousPage()" [disabled]="currentPage === 1">‚¨ÖÔ∏è ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
    <span>‡∏´‡∏ô‡πâ‡∏≤ {{ currentPage }}</span>
    <button (click)="nextPage()" [disabled]="currentPage * itemsPerPage >= filteredEmployees.length">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è</button>
  </div>

  <app-employee-add *ngIf="showAddModal" (close)="showAddModal = false"
    (saved)="showAddModal = false; fetchEmployees()">
  </app-employee-add>
</div>